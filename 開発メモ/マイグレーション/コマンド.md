# Flask-Migrate
## äº‹å‰æº–å‚™

### Flask-Migrate ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆã¾ã ãªã‚‰ï¼‰ï¼š
    pip install Flask-Migrate

### app.pyã«ä»¥ä¸‹ã‚’è¿½åŠ 
    from flask_migrate import Migrate
    migrate = Migrate(app, db)

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ«ãƒ¼ãƒˆã§ä»¥ä¸‹ã‚’æ‰“ã¤ï¼ˆ= ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ãƒ»ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¸Šï¼‰
    flask db init
â€»ã“ã‚Œã¯ã€Œã‚³ãƒ³ã‚½ãƒ¼ãƒ«ï¼ˆã‚¿ãƒ¼ãƒŸãƒŠãƒ«ï¼‰ã€ã§æ‰“ã¡ã¾ã™ã€‚Pythonå¯¾è©±ãƒ¢ãƒ¼ãƒ‰ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚


## ã‚«ãƒ©ãƒ è¿½åŠ æ™‚ã®æ“ä½œï¼ˆæ¯å›ï¼‰
â€»ä¸‹è¨˜2ã¤ã‚‚ ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ï¼ˆã‚¿ãƒ¼ãƒŸãƒŠãƒ«ï¼‰ã§æ‰“ã¤ã‚³ãƒãƒ³ãƒ‰ ã§ã™ã€‚
### ãƒ¢ãƒ‡ãƒ«ã«ã‚«ãƒ©ãƒ ã‚’è¿½åŠ ã—ãŸã‚ã¨ï¼š
    flask db migrate -m "add age column to user"

### è¿½åŠ ã‚’å®Ÿéš›ã®DBã«åæ˜ 
    flask db upgrade

## æ—¢å­˜ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã«è¿½åŠ ã—ãŸã‚«ãƒ©ãƒ ã«å…¥ã‚‹å€¤ã®å‡¦ç†
SQLiteã§ ALTER TABLE ã™ã‚‹ã¨ãã« NOT NULL åˆ¶ç´„ã‚’ã¤ã‘ã¦ã„ã‚‹ã®ã« DEFAULT ãŒæŒ‡å®šã•ã‚Œã¦ã„ãªã„ã¨ã€
SQLiteã€Œæ—¢å­˜ãƒ¬ã‚³ãƒ¼ãƒ‰ã«NULLã‚’å…¥ã‚Œã‚‹ã‚ã‘ã«ã¯ã„ã‹ã‚“ã‚ˆï¼ã€â†’ 

    OperationalError: Cannot add a NOT NULL column with default value NULL

### è©²å½“ã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãã¾ã™
ï¼ˆä¾‹ï¼šmigrations/versions/bdd19fa63016_add_column_puroduct_number_tb.pyï¼‰
op.add_column ã®ã¨ã“ã‚ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«ç·¨é›†ï¼š

    with op.batch_alter_table('product_number') as batch_op:
        batch_op.add_column(sa.Column('serial_no', sa.String(length=20), nullable=False, server_default=''))
ğŸ”¸ server_default='' ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€SQLiteã®ã‚¨ãƒ©ãƒ¼ã‚’å›é¿ã§ãã¾ã™ã€‚

### ä¿å­˜ã—ãŸã‚‰å†åº¦å®Ÿè¡Œ
    flask db upgrade